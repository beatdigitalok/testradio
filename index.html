<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mbogi Multimedia Hub</title>
    <style>
        /* --- Estilos Generales --- */
        body { font-family: Arial, sans-serif; background:#121212; color:#fff; margin:0; }
        header { background:#1db954; padding:15px; text-align:center; font-size:22px; font-weight:bold; }
        section { padding:20px; margin-bottom:20px; }
        h2 { border-bottom:2px solid #1db954; padding-bottom:5px; }
        /* --- Estilos de Componentes --- */
        .card { 
            background:#1e1e1e; padding:10px; border-radius:8px; margin:10px 0; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s;
        }
        .card:hover {
            transform: translateY(-2px);
            background: #282828;
        }
        iframe, audio, video { width:100%; border:none; border-radius:8px; }
        select { 
            width: 100%; 
            padding: 8px; 
            margin: 8px 0; 
            background: #1e1e1e; 
            color: #fff; 
            border: 1px solid #1db954; 
            border-radius: 5px; 
            box-sizing: border-box; 
        }
        a { color: #1db954; text-decoration: none; }
        a:hover { text-decoration: underline; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</head>
<body>

<header>üéµ Mbogi Multimedia Hub - Radios ¬∑ TV ¬∑ Pelis ¬∑ Tendencias</header>

<section id="lastfm">
    <h2>üìà Tendencias Musicales (Last.fm Top Tracks)</h2>
    <div id="lastfmTracks">Cargando top tracks...</div>
    <p style="font-size: 0.9em; margin-top: 15px;">
        *Esta secci√≥n muestra las canciones m√°s populares globalmente, pero no las reproduce directamente. 
        Para reproducci√≥n, usa la secci√≥n **Radios** o integra otra fuente de audio legal y libre de API.*
    </p>
</section>

---

<section id="radio">
    <h2>üìª Radios</h2>
    <select id="countrySelect"></select>
    <select id="radioSelect"></select>
    <audio id="radioPlayer" controls autoplay></audio>
</section>

<section id="tv">
    <h2>üì∫ TV en Vivo</h2>
    <select id="tvSelect"></select>
    <video id="tvPlayer" controls autoplay></video>
</section>

<section id="movies">
    <h2>üé¨ Pel√≠culas y Series</h2>
    <select id="movieSelect"></select>
    <video id="moviePlayer" controls autoplay></video>
</section>


<script>
// =====================================================================
// === Claves API ===
// =====================================================================
const LASTFM_API_KEY = "2ec6a460145f44fc845dfc771f5f701b"; 

// =====================================================================
// === Funciones de M√∫sica (Last.fm) ===
// =====================================================================

/* --- Last.fm: Top Tracks --- */
async function loadLastFm() {
    const method = "chart.gettoptracks";
    const limit = 10;
    const url = `https://ws.audioscrobbler.com/2.0/?method=${method}&api_key=${LASTFM_API_KEY}&format=json&limit=${limit}`;

    try {
        const res = await fetch(url);
        const data = await res.json();
        let html = "";
        
        if (data.tracks && data.tracks.track) {
            data.tracks.track.forEach(t => {
                html += `<div class="card">
                    <strong>${t.name}</strong> - ${t.artist.name} 
                    (<a href="${t.url}" target="_blank">Ver en Last.fm</a>)
                </div>`;
            });
        } else {
            html = "<p>‚ö†Ô∏è No se pudieron cargar las tendencias de Last.fm. Revisa tu API Key y la consola.</p>";
        }
        document.getElementById("lastfmTracks").innerHTML = html;
    } catch (err) {
        document.getElementById("lastfmTracks").innerHTML = "<p>‚ùå Error de conexi√≥n al cargar tendencias de Last.fm.</p>";
        console.error("Error Last.fm:", err);
    }
}


// =====================================================================
// === Funciones de Radio (Radio Browser) ===
// =====================================================================
async function loadCountries() {
    const res = await fetch("https://de1.api.radio-browser.info/json/countries");
    const countries = await res.json();
    const countrySelect = document.getElementById("countrySelect");
    countries.forEach(c => {
        const opt = document.createElement("option");
        opt.value = c.name;
        opt.textContent = c.name;
        countrySelect.appendChild(opt);
    });
    countrySelect.value = "Argentina";
    loadRadios(countrySelect.value);
    countrySelect.addEventListener("change", () => {
        loadRadios(countrySelect.value);
    });
}

async function loadRadios(country) {
    const res = await fetch(`https://de1.api.radio-browser.info/json/stations/bycountry/${encodeURIComponent(country)}`);
    const radios = await res.json();
    const radioSelect = document.getElementById("radioSelect");
    radioSelect.innerHTML = "";
    
    radios.slice(0, 20).forEach(r => { 
        const opt = document.createElement("option");
        opt.value = r.url_resolved;
        opt.textContent = r.name;
        radioSelect.appendChild(opt);
    });
    const player = document.getElementById("radioPlayer");
    
    radioSelect.addEventListener("change", () => {
        player.src = radioSelect.value;
        player.play();
    });
    
    if (radioSelect.value) {
        player.src = radioSelect.value;
        player.play();
    }
}

// =====================================================================
// === Funciones de TV / Pelis (Demos IPTV) ===
// =====================================================================
function playHLS(videoElement, url) {
    if (Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(url);
        hls.attachMedia(videoElement);
        videoElement.play();
    } else if (videoElement.canPlayType("application/vnd.apple.mpegurl")) {
        videoElement.src = url;
        videoElement.play();
    } else {
        console.error("Tu navegador no soporta la reproducci√≥n de este stream.");
    }
}

/* --- IPTV: canales demo --- */
function loadIPTV() {
    const channels = [
        {name: "Canal Demo 1 (Mux)", url: "https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8"},
        {name: "Canal Demo 2 (Test)", url: "https://test-streams.mux.dev/test_001/stream.m3u8"}
    ];
    const select = document.getElementById("tvSelect");
    channels.forEach(c => {
        const opt = document.createElement("option");
        opt.value = c.url;
        opt.textContent = c.name;
        select.appendChild(opt);
    });
    const video = document.getElementById("tvPlayer");
    
    playHLS(video, select.value);
    select.addEventListener("change", () => {
        playHLS(video, select.value);
    });
}

/* --- Pelis / Series: demos --- */
function loadMovies() {
    const movies = [
        {name: "Big Buck Bunny (Demo)", url: "https://test-streams.mux.dev/bigbuckbunny/master.m3u8"},
        {name: "Serie Demo Cap√≠tulo 1", url: "https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8"}
    ];
    const select = document.getElementById("movieSelect");
    movies.forEach(m => {
        const opt = document.createElement("option");
        opt.value = m.url;
        opt.textContent = m.name;
        select.appendChild(opt);
    });
    const player = document.getElementById("moviePlayer");
    
    playHLS(player, select.value);
    select.addEventListener("change", () => {
        playHLS(player, select.value);
    });
}

// =====================================================================
// === Inicializaci√≥n ===
// =====================================================================
document.addEventListener("DOMContentLoaded", () => {
    loadLastFm(); 
    loadCountries();
    loadIPTV();
    loadMovies();
});
</script>

</body>
</html>